<!DOCTYPE html>
<html lang="en-IN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Payment - Electronics Store</title>
<link rel="icon" type="image/x-icon" href="../assets/infinityMedia/favicon.png">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="../assets/css/custom.css">
<style>
body {
font-family: 'Roboto', sans-serif;
background-color: #f8f9fa;
}

.header-container {
background: linear-gradient(135deg, #2874f0, #1e5bb8);
box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.step-indicator {
display: flex;
justify-content: center;
align-items: center;
padding: 20px 0;
background: white;
margin-bottom: 20px;
}

.step {
width: 40px;
height: 40px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
margin: 0 20px;
font-weight: bold;
position: relative;
}

.step.active {
background: #2874f0;
color: white;
}

.step.completed {
background: #28a745;
color: white;
}

.step.pending {
background: #e9ecef;
color: #6c757d;
}

.step::after {
content: '';
position: absolute;
top: 50%;
left: 100%;
width: 40px;
height: 2px;
background: #e9ecef;
transform: translateY(-50%);
}

.step:last-child::after {
display: none;
}

.step.completed::after {
background: #28a745;
}

.payment-card {
background: white;
border-radius: 8px;
padding: 20px;
margin-bottom: 20px;
}

.payment-card h6 {
color: #333;
font-weight: 600;
margin-bottom: 15px;
border-bottom: 1px solid #eee;
padding-bottom: 10px;
}

.payment-method {
border: 1px solid #ddd;
border-radius: 8px;
padding: 15px;
margin-bottom: 15px;
cursor: pointer;
transition: all 0.3s ease;
}

.payment-method:hover {
border-color: #2874f0;
background-color: #f8f9ff;
}

.payment-method.selected {
border-color: #2874f0;
background-color: #f8f9ff;
}

.payment-method input[type="radio"] {
margin-right: 10px;
}

.payment-icon {
width: 30px;
height: 30px;
margin-right: 10px;
}

.order-total {
background: #f8f9fa;
border-radius: 8px;
padding: 15px;
margin-bottom: 20px;
}

.total-row {
display: flex;
justify-content: space-between;
margin-bottom: 8px;
}

.total-row.final {
font-weight: 600;
font-size: 18px;
color: #333;
border-top: 1px solid #ddd;
padding-top: 10px;
margin-top: 10px;
}

.btn-pay {
background: #ff6b35;
border: none;
border-radius: 8px;
padding: 15px;
font-weight: 600;
color: white;
width: 100%;
transition: all 0.3s ease;
}

.btn-pay:hover {
background: #e55a2b;
}

.btn-pay:disabled {
background: #ccc;
cursor: not-allowed;
}

.security-info {
background: #e7f3ff;
border: 1px solid #b3d9ff;
border-radius: 8px;
padding: 15px;
margin-bottom: 20px;
font-size: 14px;
color: #0066cc;
}
</style>
</head>
<body>

<!-- Header -->
<div class="container-fluid py-2 header-container">
<div class="row align-items-center">
<div class="col-2">
<div class="menu-icon" onclick="goBack()">
<svg width="19" height="16" viewBox="0 0 19 16" xmlns="http://www.w3.org/2000/svg">
<path d="M17.556 7.847H1M7.45 1L1 7.877l6.45 6.817" stroke="#FFF" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"></path>
</svg>
</div>
</div>
<div class="col-8 text-center">
<h5 class="text-white mb-0">Payment</h5>
</div>
<div class="col-2"></div>
</div>
</div>

<!-- Progress Steps -->
<div class="step-indicator">
<div class="step completed">1</div>
<div class="step completed">2</div>
<div class="step active">3</div>
</div>

<div class="text-center mb-4">
<small class="text-muted">Address â†’ Order Summary â†’ Payment</small>
</div>

<div class="container">
<!-- Order Total -->
<div class="order-total"><!DOCTYPE html>
<html lang="en-IN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Payment - Electronics Store</title>
<link rel="icon" type="image/x-icon" href="../assets/infinityMedia/favicon.png">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="../assets/css/custom.css">
<style>
body {
font-family: 'Roboto', sans-serif;
background-color: #f8f9fa;
}

.header-container {
background: linear-gradient(135deg, #2874f0, #1e5bb8);
box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.step-indicator {
display: flex;
justify-content: center;
align-items: center;
padding: 20px 0;
background: white;
margin-bottom: 20px;
}

.step {
width: 40px;
height: 40px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
margin: 0 20px;
font-weight: bold;
position: relative;
}

.step.active {
background: #2874f0;
color: white;
}

.step.completed {
background: #28a745;
color: white;
}

.step.pending {
background: #e9ecef;
color: #6c757d;
}

.step::after {
content: '';
position: absolute;
top: 50%;
left: 100%;
width: 40px;
height: 2px;
background: #e9ecef;
transform: translateY(-50%);
}

.step:last-child::after {
display: none;
}

.step.completed::after {
background: #28a745;
}

.payment-card {
background: white;
border-radius: 8px;
padding: 20px;
margin-bottom: 20px;
}

.payment-card h6 {
color: #333;
font-weight: 600;
margin-bottom: 15px;
border-bottom: 1px solid #eee;
padding-bottom: 10px;
}

.payment-method {
border: 2px solid #e9ecef;
border-radius: 8px;
padding: 15px;
margin-bottom: 15px;
cursor: pointer;
transition: all 0.3s ease;
}

.payment-method:hover {
border-color: #2874f0;
}

.payment-method.selected {
border-color: #2874f0;
background-color: #f8f9ff;
}

.payment-method input[type="radio"] {
margin-right: 10px;
}

.payment-icon {
width: 30px;
height: 30px;
margin-right: 10px;
}

.order-total {
background: #f8f9fa;
border-radius: 8px;
padding: 15px;
margin-bottom: 20px;
}

.total-row {
display: flex;
justify-content: space-between;
margin-bottom: 5px;
}

.total-row.final {
font-weight: 600;
font-size: 18px;
border-top: 1px solid #dee2e6;
padding-top: 10px;
margin-top: 10px;
}

.btn-pay {
background: #ff6b35;
border: none;
border-radius: 8px;
padding: 15px;
font-weight: 600;
color: white;
width: 100%;
transition: all 0.3s ease;
}

.btn-pay:hover {
background: #e55a2b;
}

.security-note {
background: #d4edda;
border: 1px solid #c3e6cb;
border-radius: 8px;
padding: 10px;
font-size: 12px;
color: #155724;
text-align: center;
margin-top: 15px;
}
</style>
</head>
<body>

<!-- Header -->
<div class="container-fluid py-2 header-container">
<div class="row align-items-center">
<div class="col-2">
<div class="menu-icon" onclick="goBack()">
<svg width="19" height="16" viewBox="0 0 19 16" xmlns="http://www.w3.org/2000/svg">
<path d="M17.556 7.847H1M7.45 1L1 7.877l6.45 6.817" stroke="#FFF" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"></path>
</svg>
</div>
</div>
<div class="col-8 text-center">
<h5 class="text-white mb-0">Payment</h5>
</div>
<div class="col-2"></div>
</div>
</div>

<!-- Progress Steps -->
<div class="step-indicator">
<div class="step completed">1</div>
<div class="step completed">2</div>
<div class="step active">3</div>
</div>

<div class="text-center mb-4">
<small class="text-muted">Address â†’ Order Summary â†’ Payment</small>
</div>

<div class="container">
<!-- Order Total -->
<div class="order-total">
<div class="total-row">
<span>Subtotal:</span>
<span>â‚¹<span id="subtotal">0.00</span></span>
</div>
<div class="total-row">
<span>Delivery:</span>
<span class="text-success">FREE</span>
</div>
<div class="total-row">
<span>Taxes:</span>
<span>â‚¹<span id="taxes">0.00</span></span>
</div>
<div class="total-row final">
<span>Total Amount:</span>
<span>â‚¹<span id="totalAmount">0.00</span></span>
</div>
</div>

<!-- Payment Methods -->
<div class="payment-card">
<h6>Select Payment Method</h6>
<form id="paymentForm">
<div class="payment-method" onclick="selectPaymentMethod('razorpay')">
<input type="radio" name="paymentMethod" value="razorpay" id="razorpay">
<svg class="payment-icon" viewBox="0 0 24 24" fill="#2874f0">
<path d="M12 2L2 7v10c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7l-10-5z"/>
</svg>
<label for="razorpay" class="mb-0">
<strong>Razorpay</strong><br>
<small class="text-muted">Credit/Debit Card, UPI, Net Banking</small>
</label>
</div>

<div class="payment-method" onclick="selectPaymentMethod('cod')">
<input type="radio" name="paymentMethod" value="cod" id="cod">
<svg class="payment-icon" viewBox="0 0 24 24" fill="#28a745">
<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
</svg>
<label for="cod" class="mb-0">
<strong>Cash on Delivery</strong><br>
<small class="text-muted">Pay when you receive</small>
</label>
</div>
</form>
</div>

<!-- Place Order Button -->
<button class="btn btn-pay" onclick="processPayment()">
<span id="payButtonText">Place Order</span>
</button>

<div class="security-note">
ðŸ”’ Your payment information is secure and encrypted
</div>
</div>

<!-- Razorpay Script -->
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="../assets/js/cart.js"></script>
<script src="../assets/js/checkout.js"></script>
<script>
function goBack() {
window.location.href = 'order-summary.html';
}

function selectPaymentMethod(method) {
// Remove previous selections
document.querySelectorAll('.payment-method').forEach(el => {
el.classList.remove('selected');
});

// Select current method
document.querySelector(`input[value="${method}"]`).checked = true;
document.querySelector(`input[value="${method}"]`).closest('.payment-method').classList.add('selected');

// Update button text
const payButton = document.getElementById('payButtonText');
if (method === 'razorpay') {
payButton.textContent = 'Pay Now';
} else {
payButton.textContent = 'Place Order';
}
}

function loadOrderSummary() {
const orderSummary = getOrderSummary();
if (orderSummary) {
document.getElementById('subtotal').textContent = orderSummary.subtotal.toFixed(2);
document.getElementById('taxes').textContent = orderSummary.taxes.toFixed(2);
document.getElementById('totalAmount').textContent = orderSummary.total.toFixed(2);
}
}

function processPayment() {
const selectedPayment = document.querySelector('input[name="paymentMethod"]:checked');
    
if (!selectedPayment) {
alert('Please select a payment method');
return;
}

const orderSummary = getOrderSummary();
if (!orderSummary) {
alert('Order information not found');
return;
}

if (selectedPayment.value === 'razorpay') {
initiateRazorpayPayment(orderSummary);
} else {
// Cash on Delivery
processCODOrder(orderSummary);
}
}

function initiateRazorpayPayment(orderSummary) {
const options = {
key: "rzp_test_1234567890", // Replace with your actual Razorpay key
amount: Math.round(orderSummary.total * 100), // Amount in paise
currency: "INR",
name: "Electronics Store",
description: "Purchase from Electronics Store",
image: "../assets/infinityMedia/favicon.png",
handler: function (response) {
// Payment successful
const paymentData = {
razorpay_payment_id: response.razorpay_payment_id,
order_id: generateOrderId(),
amount: orderSummary.total,
payment_method: 'razorpay',
status: 'paid'
};
            
savePaymentInfo(paymentData);
clearCart();
clearCheckoutData();
window.location.href = 'order-success.html';
},
prefill: {
name: orderSummary.address.fullName,
contact: orderSummary.address.mobile
},
theme: {
color: "#2874f0"
}
};

const rzp = new Razorpay(options);
rzp.open();
}

function processCODOrder(orderSummary) {
const paymentData = {
order_id: generateOrderId(),
amount: orderSummary.total,
payment_method: 'cod',
status: 'pending'
};
    
savePaymentInfo(paymentData);
clearCart();
clearCheckoutData();
window.location.href = 'order-success.html';
}

function generateOrderId() {
return 'ORD' + Date.now() + Math.random().toString(36).substr(2, 5).toUpperCase();
}

// Load order summary on page load
document.addEventListener('DOMContentLoaded', function() {
loadOrderSummary();
// Default select first payment method
selectPaymentMethod('razorpay');
});
</script>
</body>
</html>
